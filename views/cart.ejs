<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel="stylesheet" href="/stylesheets/cart.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@4.1.0/fonts/remixicon.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">

  </head>
  <body>
    <%- include('header2.ejs') -%>
    <div class="main">

      <div class="page-link">
        <a href="/"> Home> </a>
        <a href="/shop"> shop> </a>
      </div>
      <!-- ------------------------------- Cart page start------------------------------ -->
      <div class="shopping-cart">
        <!-- Title -->
        <div class="title">
          <span>Your Cart</span>
          <span>
            <a class="clearCartBtn" href="/clearCart">Clear all</a>
          </span>
        </div>
      
        <form
          class="itemCartShowingWindow-form"
          action="/updateQty"
          method="POST"
        >
          <button type="submit" class="updateQtyBtn">Update quantity</button>

          <% totalPrice = 0 %> <% if (products && products.length > 0) { %>
          <div class="itemCartShowingWindow">
            <!-- item div -->
            <% products.map((product) => { %>
            <div class="cart_item">
              <div class="cart_buttons">
                <a href="/removeCartItem/<%= product.pid %>,<%= product.vid %>">
                  <span class="delete-btn"
                    ><img src="/icons/delete.jpeg" alt=""
                  /></span>
                </a>
              </div>

              <div class="img-info">
              <div class="cart_image">
                <img
                  class="prodImgCart"
                  src="/images/<%= product.image1 %>"
                  alt=""
                />
              </div>

              <div class="description">
                <span><%= product.name %></span>
                <span><%= product.description %></span>
              </div>
            </div>
              <div class="cart_quantity">
                <span>Change Quantity &nbsp;</span>
                <input
                  class="quanityCart"
                  type="text"
                  name="updatedQuantities[<%= product.pid %>-<%= product.vid %>]"
                  value="<%= product.quantity %>"
                />
              </div>

              <div class="total-price">
                <span style="color: black"
                  >Rs- <%= product.individualPrice %> x <%= product.quantity
                  %></span
                >
              </div>
            </div>

            <% totalPrice += (product.individualPrice * product.quantity) %> <%
            }) %>
          </div>
        </form>

        <% } else { %>
        <div class="itemCartShowingWindow">
          <!-- item div -->
          <h2 class="emptyCartHead">Cart is empty.</h2>
        </div>
        <% } %>
      
        <div class="feeDivCard">
          <ul class="feeDivCard-ul">
            <li>
              <h6>Total</h6>
              <span>Rs <%= totalPrice %></span>
            </li>
            <li>
              <h6>Delivery Charges</h6>
              <span>Rs 00.00</span>
            </li>
            <li>
              <h6>Net Total</h6>
              <span>Rs <%= eval( totalPrice + 00 ) %></span>
            </li>
          </ul>
          <a class="checkoutAtag" href="/Enquiry"
            ><button class="checkoutBtn">Enquiry</button></a
          >
        </div>
      </div>

     <%- include('footer.ejs') -%>
      
    </div>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"
      integrity="sha512-7eHRwcbYkK4d9g/6tD/mhkf++eoTHwpNM9woBxtPUBWm67zeAfFC+HrdoE2GanKeocly/VxeLvIqwvCdk7qScg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"
      integrity="sha512-onMTRKJBKz8M1TnqqDuGBlowlH0ohFzMXYRNebz+yOcc5TQr/zAKsthzhuv0hiyUKEiQEQXEynnXCvNTOk50dg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <!-- <script src="/javascripts/script.js"></script> -->
  </body>
</html>
